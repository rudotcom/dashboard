{% extends "base.html" %}
{% load static %}

{% block page_css %}
{% endblock page_css %}

{% block title %}Загрузка{% endblock %}
{% block breadcrumbs %}<span class="text-muted fw-light"><a href="{% url 'dashboard:data-list' 'sources' %}">Справочники</a>/</span> Загрузка файла данных {% endblock %}

{% block content %}

              <!-- Basic Layout & Basic with Icons -->
              <div class="row">
                <!-- Basic with Icons -->
                <div class="col-xxl">
                  <div class="card mb-4">
                    <div class="card-header d-flex align-items-center justify-content-between">
                      <h5 class="mb-0"><i class="bx bx-link-alt me-1"></i> Создание нового источника данных</h5>
                      <small class="text-muted float-end"><i class="bx bx-link-alt me-1"></i> Источник данных используется для создания графиков:
                          <button class="btn btn-xs rounded-pill btn-outline-info" type="button" data-bs-toggle="offcanvas" data-bs-target="#offcanvasBoth" aria-controls="offcanvasBoth">
                           Подробнее
                          </button>
                      </small>
                    </div>
                        <div
                          class="offcanvas offcanvas-end"
                          data-bs-scroll="true"
                          tabindex="-1"
                          id="offcanvasBoth"
                          aria-labelledby="offcanvasBothLabel"
                        >
                          <div class="offcanvas-header">
                            <h5 id="offcanvasBothLabel" class="offcanvas-title">Создание нового источника данных</h5>
                            <button
                              type="button"
                              class="btn-close text-reset"
                              data-bs-dismiss="offcanvas"
                              aria-label="Close"
                            ></button>
                          </div>
                          <div class="offcanvas-body mx-0 flex-grow-0">
                            <div class="col-md mb-4 mb-md-0">
                              <small class="text-light fw-semibold">Подготовка к созданию графика</small>
                              <div class="accordion mt-3" id="accordionExample">
                                <div class="card accordion-item active">
                                  <h2 class="accordion-header" id="headingOne">
                                    <button
                                      type="button"
                                      class="accordion-button"
                                      data-bs-toggle="collapse"
                                      data-bs-target="#accordionOne"
                                      aria-expanded="true"
                                      aria-controls="accordionOne"
                                    >
                                      <i class="bx bx-link-alt me-1"></i> Источник данных
                                    </button>
                                  </h2>

                                  <div
                                    id="accordionOne"
                                    class="accordion-collapse collapse show"
                                    data-bs-parent="#accordionExample"
                                  >
                                    <div class="accordion-body">
                                    <!-- List group Numbered -->
                                      <div class="demo-inline-spacing mt-3">
                                        <ol class="list-group list-group-numbered">
                                          <li class="list-group-item">Используется для создания графиков</li>
                                          <li class="list-group-item">Создается из загруженной таблицы Excel</li>
                                          <li class="list-group-item">Данные загружаются и сохраняются на портале "как есть"</li>
                                          <li class="list-group-item">На этапе создания графика можно будет выбрать колонки
                                              для фильтрации и группировки данных</li>
                                          <li class="list-group-item">Пользователь графика (дашборда) сможет фильтровать данные по выбранным колонкам</li>
                                        </ol>
                                      </div>
                                    <!--/ List group Numbered -->

                                    </div>
                                  </div>
                                </div>
                                <div class="card accordion-item">
                                  <h2 class="accordion-header" id="headingTwo">
                                    <button
                                      type="button"
                                      class="accordion-button collapsed"
                                      data-bs-toggle="collapse"
                                      data-bs-target="#accordionTwo"
                                      aria-expanded="false"
                                      aria-controls="accordionTwo"
                                    >
                                      <i class='bx bx-table' ></i> Требования к таблице в файле Excel
                                    </button>
                                  </h2>
                                  <div
                                    id="accordionTwo"
                                    class="accordion-collapse collapse"
                                    aria-labelledby="headingTwo"
                                    data-bs-parent="#accordionExample"
                                  >
                                    <div class="accordion-body">
                                    <!-- List group Numbered -->
                                      <div class="demo-inline-spacing mt-3">
                                        <ol class="list-group list-group-numbered">
                                          <li class="list-group-item">Таблица должна находиться на активном листе книги Excel. Остальные листы игнорируются</li>
                                          <li class="list-group-item">На активном листе книги Excel должна находиться только одна таблица</li>
                                          <li class="list-group-item">Заголовок таблицы должен находиться в первой строке таблицы, начиная с первого столбца</li>
                                          <li class="list-group-item">Заголовки столбцов должны быть уникальными во избежание путаницы данных</li>
                                          <li class="list-group-item">Данные должны начинаться со второй строки таблицы.
                                              Не должно быть промежуточных строк, не содержащих актуальные для графиков данные</li>
                                        </ol>
                                      </div>
                                    <!--/ List group Numbered -->

                                    </div>
                                  </div>
                                </div>
                                <div class="card accordion-item">
                                  <h2 class="accordion-header" id="headingThree">
                                    <button
                                      type="button"
                                      class="accordion-button collapsed"
                                      data-bs-toggle="collapse"
                                      data-bs-target="#accordionThree"
                                      aria-expanded="false"
                                      aria-controls="accordionThree"
                                    >
                                      Accordion Item 3
                                    </button>
                                  </h2>
                                  <div
                                    id="accordionThree"
                                    class="accordion-collapse collapse"
                                    aria-labelledby="headingThree"
                                    data-bs-parent="#accordionExample"
                                  >
                                    <div class="accordion-body">
                                      Oat cake toffee chocolate bar jujubes. Marshmallow brownie lemon drops cheesecake. Bonbon
                                      gingerbread marshmallow sweet jelly beans muffin. Sweet roll bear claw candy canes oat cake
                                      dragée caramels. Ice cream wafer danish cookie caramels muffin.
                                    </div>
                                  </div>
                                </div>
                              </div>
                            </div>
                              <br>
                              <button
                              type="button"
                              class="btn btn-outline-success d-grid w-100"
                              data-bs-dismiss="offcanvas"
                            >
                              Закрыть
                            </button>
                          </div>
                        </div>

                    <div class="card-body">
                      <form method="post" enctype="multipart/form-data">
                        {% csrf_token %}
                        <div class="row mb-3">
                          <label class="col-sm-2 col-form-label" for="basic-icon-default-company">{{ form.name.label }}</label>
                          <div class="col-sm-10">
                            <div class="input-group input-group-merge">
                              <span id="basic-icon-default-company2" class="input-group-text"
                                ><i class="bx bx-link-alt me-1"></i></span>
                                {{ form.name }}
                            </div>
                            <div class="form-text">Укажите понятное наименование. Ваш источник данных будут использовать ваши коллеги и руководители</div>
                            {% if form.name.errors %}
                                <div class="alert alert-danger" role="alert">
                                    {% for error in form.name.errors %}
                                        {{ error }}
                                    {% endfor %}
                                </div>
                            {% endif %}
                          </div>
                        </div>
                        <div class="row mb-3">
                          <label class="col-sm-2 form-label" for="basic-icon-default-message">Описание</label>
                          <div class="col-sm-10">
                            <div class="input-group input-group-merge">
                              <span id="basic-icon-default-message2" class="input-group-text"
                                ><i class="bx bx-comment"></i
                              ></span>
                              {{ form.description }}
                            {% if form.description.errors %}
                                <div class="alert alert-danger" role="alert">
                                    {% for error in form.description.errors %}
                                        {{ error }}
                                    {% endfor %}
                                </div>
                            {% endif %}
                            </div>
                          </div>
                        </div>
                        <div class="row mb-3">
                          <label class="col-sm-2 form-label" for="basic-icon-default-message">Файл Excel</label>
                          <div class="col-sm-10">
                              {{ form.csv }}
                            {% if form.csv.errors %}
                                <div class="alert alert-danger" role="alert">
                                    {% for error in form.csv.errors %}
                                        {{ error }}
                                    {% endfor %}
                                </div>
                            {% endif %}
                          </div>
                        </div>
                        <div class="row mb-3">
                          <label class="col-sm-2 form-label" for="basic-icon-default-message">Конец периода</label>
                          <div class="col-sm-3">
                              {{ form.date }}
                            {% if form.date.errors %}
                                <div class="alert alert-danger" role="alert">
                                    {% for error in form.date.errors %}
                                        {{ error }}
                                    {% endfor %}
                                </div>
                            {% endif %}
                          </div>
                          <div class="col-sm-6">
                              <div class="form-check form-switch mb-2">
                                  {{ form.accrual }}
                                <label class="form-check-label" for="flexSwitchCheckChecked"
                                  ><i class='bx bx-calendar-plus' ></i> Календарное накопление данных (нарастающий итог)
                                  <button
                                    type="button"
                                    class="btn btn-xs rounded-pill btn-icon btn-outline-secondary"
                                    data-bs-toggle="popover"
                                    data-bs-offset="0,14"
                                    data-bs-placement="bottom"
                                    data-bs-html="true"
                                    data-bs-content="<p>Набор данных содержит данные за календарный период</p> <div class='d-flex justify-content-between'>&nbsp;<button type='button' class='btn btn-sm btn-primary' data-bs-toggle='modal' data-bs-target='#modalCenter'>Подробнее</button></div>"
                                    title="Нарастающий итог"
                                  >
                                    <i class='bx bx-question-mark'></i>
                                  </button>

                                </label>
                              </div>
                          </div>
                        </div>
                        <div class="row justify-content-end">
                          <div class="col-sm-10">
                            <button type="submit" class="btn btn-primary">Загрузить файл</button>
                          </div>
                        </div>
                      </form>
                    </div>
                  </div>
                </div>
              </div>
            </div>

                            <!-- Modal 1-->
                        <div
                          class="modal fade"
                          id="modalCenter"
                          aria-labelledby="modalToggleLabel"
                          tabindex="-1"
                          style="display: none"
                          aria-hidden="true"
                        >
                          <div class="modal-dialog modal-dialog-centered">
                            <div class="modal-content">
                              <div class="modal-header">
                                <h5 class="modal-title" id="modalToggleLabel">Таблица с нарастающим итогом</h5>
                                <button
                                  type="button"
                                  class="btn-close"
                                  data-bs-dismiss="modal"
                                  aria-label="Close"
                                ></button>
                              </div>
                              <div class="modal-body">Объяснение что такое таблица с нарастающим итогом, для чего она используется.
                              Как понять, что это она? Присутствует колонка с различными датами.</div>
                              </div>
                            </div>
                          </div>

{% endblock %}

{% block page_js %}
<script src="{% static 'js/dashboards-analytics.js' %}"></script>
<script src="{% static 'js/app-logistics-dashboard.js' %}"></script>
<script src="{% static 'js/ui-popover.js' %}"></script>
{% endblock %}
